<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Villares - Documentos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè†</text></svg>">
    <!-- ADICIONAR: Font Awesome para √≠cones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
      <script>
        (function() {
            const isAuthenticated = localStorage.getItem('isAuthenticated');
            const currentUser = localStorage.getItem('currentUser');
            
            if (!isAuthenticated || !currentUser) {
                console.log('‚ùå Usu√°rio n√£o autenticado, redirecionando para login...');
                localStorage.removeItem('isAuthenticated');
                localStorage.removeItem('currentUser');
                window.location.href = 'login.html';
            }
        })();
    </script>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>üè† Villares Im√≥veis</h2>
            <p id="current-user">Usu√°rio</p>
        </div>

        <ul class="sidebar-menu">
            <li><a href="#" onclick="showPage('dashboard')" class="active">üìä Dashboard</a></li>
            <!-- ADICIONAR: Item do menu para Vistorias -->
            <li><a href="#" onclick="showPage('vistorias')">üì∏ Vistorias</a></li>
            <li><a href="#" onclick="logout()" style="color: #dc3545;">üö™ Sair</a></li>
        </ul>

        <div class="frase-do-dia">
            <h4>üí° Frase do Dia</h4>
            <p id="frase-texto">Carregando...</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard -->
        <div id="dashboard" class="dashboard-container">
            <div class="page-header">
                <h1>üìä Dashboard - Sistema de Documentos</h1>
                <div class="user-info">
                    <span id="current-user-display">Usu√°rio</span>
                </div>
            </div>

            <div class="alert alert-info">
                <strong>Bem-vindo ao Sistema Villares Im√≥veis!</strong> Selecione um documento para gerar.
            </div>

            <!-- Cards de Formul√°rios -->
            <div class="form-cards-section">
                <h2 class="section-title">üìã Formul√°rios</h2>
                <div class="row">
                    <div class="col-4">
                        <a href="#" onclick="showPage('cadastro-imovel')" class="card-button">
                            <div class="card-icon">üè†</div>
                            <div class="card-title">Cadastro de Im√≥vel</div>
                            <div class="card-description">Cadastrar novo im√≥vel no sistema</div>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="#" onclick="showPage('contrato-locacao')" class="card-button">
                            <div class="card-icon">üìù</div>
                            <div class="card-title">Contrato de Loca√ß√£o</div>
                            <div class="card-description">Gerar contrato de loca√ß√£o</div>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="#" onclick="showPage('contrato-administracao')" class="card-button">
                            <div class="card-icon">üìã</div>
                            <div class="card-title">Contrato Administra√ß√£o</div>
                            <div class="card-description">Contrato de administra√ß√£o</div>
                        </a>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-4">
                        <a href="#" onclick="showPage('ficha-cadastral')" class="card-button">
                            <div class="card-icon">üìÑ</div>
                            <div class="card-title">Ficha Cadastral</div>
                            <div class="card-description">Ficha cadastral de cliente</div>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="#" onclick="showPage('recibo-aluguel')" class="card-button">
                            <div class="card-icon">üí∞</div>
                            <div class="card-title">Recibo de Aluguel</div>
                            <div class="card-description">Emitir recibo de aluguel</div>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="#" onclick="showPage('termo-vistoria')" class="card-button">
                            <div class="card-icon">üîç</div>
                            <div class="card-title">Termo de Vistoria</div>
                            <div class="card-description">Termo de vistoria do im√≥vel</div>
                        </a>
                    </div>
                </div>

                <!-- Gest√£o de Condom√≠nios -->
                <div class="row mt-3">
                    <div class="col-4">
                        <a href="#" onclick="showPage('gestao-condominios')" class="card-button">
                            <div class="card-icon">üè¢</div>
                            <div class="card-title">Gest√£o de Condom√≠nios</div>
                            <div class="card-description">Documentos para gest√£o condominial</div>
                        </a>
                    </div>

                    <div class="col-4">
                         <a href="#" class="card-button" onclick="showPage('termoEntregaChaves')">
                            <div class="card-icon">üîë</div>
                            <div class="card-title">Termo de Entrega de Chaves</div>
                            <div class="card-description">Termo para in√≠cio de loca√ß√£o</div>
                        </a>
                    </div>
                    <!-- ADICIONAR: Card do Sistema de Vistorias ao lado do Gest√£o de Condom√≠nios -->
                    <div class="col-4">
                        <a href="#" onclick="showPage('vistorias')" class="card-button">
                            <div class="card-icon">üì∏</div>
                            <div class="card-title">Sistema de Vistorias</div>
                            <div class="card-description">Upload e gest√£o de fotos de vistorias</div>
                        </a>
                    </div>
                </div>
            </div>
            
            
        </div>

        <div id="page-content"></div>
    </div>

    <!-- Incluir todos os scripts -->
    <script src="cadastroimovel.js"></script>
    <script src="contratoLocacao.js"></script>
    <script src="contratoAdministracao.js"></script>
    <script src="fichaCadastral.js"></script>
    <script src="reciboAluguel.js"></script>
    <script src="termoVistoria.js"></script>
    <script src="condominio.js"></script>
    <script src="sistemaVistorias.js"></script>
    <script src="termoEntregaChaves.js"></script>
    <script src="app.js"></script>

    <script>
        // Fun√ß√µes globais necess√°rias
        function logout() {
            localStorage.removeItem('isAuthenticated');
            localStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        }

        function goBack() {
            showPage('dashboard');
        }

        function showPage(page, event = null) {
            const pageContent = document.getElementById('page-content');
            const dashboard = document.getElementById('dashboard');
            
            // Esconder todas as p√°ginas
            dashboard.style.display = 'none';
            if (pageContent) pageContent.innerHTML = '';
            
            // Atualizar menu ativo
            document.querySelectorAll('.sidebar-menu a').forEach(item => {
                item.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                const menuItem = document.querySelector(`.sidebar-menu a[onclick*="${page}"]`);
                if (menuItem) {
                    menuItem.classList.add('active');
                }
            }
            
            // Mostrar dashboard ou p√°gina espec√≠fica
            if (page === 'dashboard') {
                dashboard.style.display = 'block';
                if (window.app) {
                    window.app.carregarFraseInternet();
                }
            } else if (page === 'vistorias') {
                if (typeof loadVistoriasPage === 'function') {
                    loadVistoriasPage();
                } else {
                    console.error('Sistema de vistorias n√£o carregado');
                    pageContent.innerHTML = `
                        <div class="page-container">
                            <div class="page-header">
                                <button class="btn btn-secondary" onclick="showPage('dashboard')">‚Üê VOLTAR</button>
                                <h1>üì∏ SISTEMA DE VISTORIAS</h1>
                            </div>
                            <div class="alert alert-danger">
                                Sistema de vistorias n√£o dispon√≠vel.
                            </div>
                        </div>
                    `;
                }
            } else {
                // USAR O pageLoaders DO app.js PARA AS OUTRAS P√ÅGINAS
                dashboard.style.display = 'none';
                
                // Verificar se existe no pageLoaders do app.js
                if (window.pageLoaders && window.pageLoaders[page]) {
                    window.pageLoaders[page]();
                } else {
                    // Fallback para o m√©todo antigo
                    switch(page) {
                        case 'cadastro-imovel':
                            if (typeof loadCadastroImovelPage === 'function') loadCadastroImovelPage();
                            break;
                        case 'contrato-locacao':
                            if (typeof loadContratoLocacaoPage === 'function') loadContratoLocacaoPage();
                            break;
                        case 'contrato-administracao':
                            if (typeof loadContratoAdministracaoPage === 'function') loadContratoAdministracaoPage();
                            break;
                        case 'ficha-cadastral':
                            if (typeof loadFichaCadastralPage === 'function') loadFichaCadastralPage();
                            break;
                        case 'recibo-aluguel':
                            if (typeof loadReciboAluguelPage === 'function') loadReciboAluguelPage();
                            break;
                        case 'termo-vistoria':
                            if (typeof loadTermoVistoriaPage === 'function') loadTermoVistoriaPage();
                            break;
                        case 'gestao-condominios':
                            if (typeof loadRelatorioPage === 'function') loadRelatorioPage();
                            break;
                        case 'termoEntregaChaves':
                            if (typeof loadTermoEntregaChavesPage === 'function') loadTermoEntregaChavesPage();
                            break;
                        default:
                            console.log('P√°gina n√£o encontrada:', page);
                            pageContent.innerHTML = '<div class="alert alert-danger">P√°gina n√£o encontrada</div>';
                    }
                }
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema carregado - Usu√°rio:', localStorage.getItem('currentUser'));
            
            // Atualizar display do usu√°rio
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                const userElements = document.querySelectorAll('#current-user, #current-user-display');
                userElements.forEach(el => {
                    if (el) el.textContent = currentUser;
                });
            }
        });
    </script>
</body>
</html>